<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.10.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>HF-PCAL95555: Platform Integration Guide</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only-darkmode-toggle.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">HF-PCAL95555<span id="projectnumber">&#160;0.1.0-dev</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">Platform Integration Guide</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md111"></a> This guide explains how to implement the hardware abstraction interface for the PCAL95555 driver on your platform.</p>
<h1><a class="anchor" id="autotoc_md112"></a>
Understanding CRTP (Curiously Recurring Template Pattern)</h1>
<p>The PCAL95555 driver uses <b>CRTP</b> (Curiously Recurring Template Pattern) for hardware abstraction. This design choice provides several critical benefits for embedded systems:</p>
<h2><a class="anchor" id="autotoc_md113"></a>
Why CRTP Instead of Virtual Functions?</h2>
<h3><a class="anchor" id="autotoc_md114"></a>
1. <b>Zero Runtime Overhead</b></h3>
<ul>
<li><b>Virtual functions</b>: Require a vtable lookup (indirect call) = ~5-10 CPU cycles overhead per call</li>
<li><b>CRTP</b>: Direct function calls = 0 overhead, compiler can inline</li>
<li><b>Impact</b>: In time-critical embedded code, this matters significantly</li>
</ul>
<h3><a class="anchor" id="autotoc_md115"></a>
2. <b>Compile-Time Polymorphism</b></h3>
<ul>
<li><b>Virtual functions</b>: Runtime dispatch - the compiler cannot optimize across the abstraction boundary</li>
<li><b>CRTP</b>: Compile-time dispatch - full optimization, dead code elimination, constant propagation</li>
<li><b>Impact</b>: Smaller code size, faster execution</li>
</ul>
<h3><a class="anchor" id="autotoc_md116"></a>
3. <b>Memory Efficiency</b></h3>
<ul>
<li><b>Virtual functions</b>: Each object needs a vtable pointer (4-8 bytes)</li>
<li><b>CRTP</b>: No vtable pointer needed</li>
<li><b>Impact</b>: Critical in memory-constrained systems (many MCUs have &lt;64KB RAM)</li>
</ul>
<h3><a class="anchor" id="autotoc_md117"></a>
4. **Type Safety**</h3>
<ul>
<li>**Virtual functions**: Runtime errors if method not implemented</li>
<li>**CRTP**: Compile-time errors if method not implemented</li>
<li>**Impact**: Catch bugs at compile time, not in the field</li>
</ul>
<h2><a class="anchor" id="autotoc_md118"></a>
How CRTP Works</h2>
<div class="fragment"><div class="line"><span class="comment">// Base template class (from pcal95555_i2c_interface.hpp)</span></div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> Derived&gt;</div>
<div class="line"><span class="keyword">class </span>I2cInterface {</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    <span class="keywordtype">bool</span> Write(uint8_t addr, uint8_t reg, <span class="keyword">const</span> uint8_t &lt;em&gt;data, <span class="keywordtype">size_t</span> len) {</div>
<div class="line">        <span class="comment">// Cast &#39;this&#39; to Derived&lt;/em&gt; and call the derived implementation</span></div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">static_cast&lt;</span>Derived*<span class="keyword">&gt;</span>(<span class="keyword">this</span>)-&gt;Write(addr, reg, data, len);</div>
<div class="line">    }</div>
<div class="line">    </div>
<div class="line">    <span class="keywordtype">bool</span> Read(uint8_t addr, uint8_t reg, uint8_t &lt;em&gt;data, <span class="keywordtype">size_t</span> len) {</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">static_cast&lt;</span>Derived&lt;/em<span class="keyword">&gt;</span>&gt;(<span class="keyword">this</span>)-&gt;Read(addr, reg, data, len);</div>
<div class="line">    }</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Your implementation</span></div>
<div class="line"><span class="keyword">class </span>MyI2c : <span class="keyword">public</span> pcal95555::I2cInterface&lt;MyI2c&gt; {</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    <span class="comment">// This method is called directly (no virtual overhead)</span></div>
<div class="line">    <span class="keywordtype">bool</span> Write(uint8_t addr, uint8_t reg, <span class="keyword">const</span> uint8_t *data, <span class="keywordtype">size_t</span> len) {</div>
<div class="line">        <span class="comment">// Your platform-specific I2C code</span></div>
<div class="line">    }</div>
<div class="line">    </div>
<div class="line">    <span class="keywordtype">bool</span> Read(uint8_t addr, uint8_t reg, uint8_t *data, <span class="keywordtype">size_t</span> len) {</div>
<div class="line">        <span class="comment">// Your platform-specific I2C code</span></div>
<div class="line">    }</div>
<div class="line">};</div>
</div><!-- fragment --><p>The key insight: <code>static_cast&lt;Derived*&gt;(this)</code> allows the base class to call methods on the derived class <b>at compile time</b>, not runtime.</p>
<h2><a class="anchor" id="autotoc_md119"></a>
Performance Comparison</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Aspect   </th><th class="markdownTableHeadNone">Virtual Functions   </th><th class="markdownTableHeadNone">CRTP    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Function call overhead   </td><td class="markdownTableBodyNone">~5-10 cycles   </td><td class="markdownTableBodyNone">0 cycles (inlined)    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Code size   </td><td class="markdownTableBodyNone">Larger (vtables)   </td><td class="markdownTableBodyNone">Smaller (optimized)    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Memory per object   </td><td class="markdownTableBodyNone">+4-8 bytes (vptr)   </td><td class="markdownTableBodyNone">0 bytes    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Compile-time checks   </td><td class="markdownTableBodyNone">No   </td><td class="markdownTableBodyNone">Yes    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Optimization   </td><td class="markdownTableBodyNone">Limited   </td><td class="markdownTableBodyNone">Full   </td></tr>
</table>
<h1><a class="anchor" id="autotoc_md120"></a>
Interface Definition</h1>
<p>The PCAL95555 driver requires you to implement the <code>I2cInterface</code> template:</p>
<p><b>Location</b>: <a href="../inc/pcal95555.hpp#L437"><code>inc/pcal95555.hpp#L437</code></a></p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> Derived&gt;</div>
<div class="line"><span class="keyword">class </span>I2cInterface {</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    <span class="comment">// Required methods (implement both)</span></div>
<div class="line">    <span class="keywordtype">bool</span> Write(uint8_t addr, uint8_t reg, <span class="keyword">const</span> uint8_t *data, <span class="keywordtype">size_t</span> len);</div>
<div class="line">    <span class="keywordtype">bool</span> Read(uint8_t addr, uint8_t reg, uint8_t *data, <span class="keywordtype">size_t</span> len);</div>
<div class="line">};</div>
</div><!-- fragment --><p><b>Required Methods</b> (must be implemented):</p><ul>
<li><code>Write()</code>: Write <code>len</code> bytes from <code>data</code> to register <code>reg</code> at I2C address <code>addr</code> (7-bit address)</li>
<li><code>Read()</code>: Read <code>len</code> bytes into <code>data</code> from register <code>reg</code> at I2C address <code>addr</code> (7-bit address)</li>
<li><code>EnsureInitialized()</code>: Ensure I2C bus is initialized and ready for communication</li>
<li>All return <code>true</code> on success, <code>false</code> on failure (NACK, timeout, etc.)</li>
</ul>
<p><b>Optional Methods</b> (can be overridden for additional functionality):</p><ul>
<li><code>SetAddressPins()</code>: Control A2-A0 address pins via GPIO (returns <code>false</code> by default if not supported)</li>
<li><code>RegisterInterruptHandler()</code>: Register interrupt handler for INT pin (returns <code>false</code> by default if not supported)</li>
</ul>
<h1><a class="anchor" id="autotoc_md121"></a>
Implementation Steps</h1>
<h2><a class="anchor" id="autotoc_md122"></a>
Step 1: Create Your Implementation Class</h2>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;pcal95555.hpp&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span>MyPlatformI2c : <span class="keyword">public</span> pcal95555::I2cInterface&lt;MyPlatformI2c&gt; {</div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">    <span class="comment">// Your platform-specific members</span></div>
<div class="line">    i2c_handle_t i2c_handle_;</div>
<div class="line">    </div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    <span class="comment">// Constructor</span></div>
<div class="line">    MyPlatformI2c(i2c_handle_t handle) : i2c_handle_(handle) {}</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Implement required methods (NO virtual keyword!)</span></div>
<div class="line">    <span class="keywordtype">bool</span> Write(uint8_t addr, uint8_t reg, <span class="keyword">const</span> uint8_t *data, <span class="keywordtype">size_t</span> len) {</div>
<div class="line">        <span class="comment">// Your I2C write implementation</span></div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">    }</div>
<div class="line">    </div>
<div class="line">    <span class="keywordtype">bool</span> Read(uint8_t addr, uint8_t reg, uint8_t *data, <span class="keywordtype">size_t</span> len) {</div>
<div class="line">        <span class="comment">// Your I2C read implementation</span></div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">    }</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Required: Ensure I2C bus is initialized and ready</span></div>
<div class="line">    <span class="keywordtype">bool</span> EnsureInitialized() {</div>
<div class="line">        <span class="keywordflow">if</span> (initialized_) {</div>
<div class="line">            <span class="keywordflow">return</span> <span class="keyword">true</span>;  <span class="comment">// Already initialized</span></div>
<div class="line">        }</div>
<div class="line">        <span class="comment">// Initialize I2C hardware, configure pins, set up bus, etc.</span></div>
<div class="line">        <span class="comment">// ...</span></div>
<div class="line">        initialized_ = <span class="keyword">true</span>;</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">    }</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Optional: Override to support dynamic address pin control</span></div>
<div class="line">    <span class="keywordtype">bool</span> SetAddressPins(<span class="keywordtype">bool</span> a0_level, <span class="keywordtype">bool</span> a1_level, <span class="keywordtype">bool</span> a2_level) {</div>
<div class="line">        <span class="comment">// Set GPIO pins connected to A2-A0 address pins</span></div>
<div class="line">        <span class="comment">// Return true if supported, false if not supported (hardwired)</span></div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">false</span>; <span class="comment">// Default: not supported</span></div>
<div class="line">    }</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Optional: Override to support hardware interrupt handling</span></div>
<div class="line">    <span class="keywordtype">bool</span> RegisterInterruptHandler(std::function&lt;<span class="keywordtype">void</span>()&gt; handler) {</div>
<div class="line">        <span class="comment">// Set up GPIO interrupt for INT pin</span></div>
<div class="line">        <span class="comment">// Call handler() when INT pin fires</span></div>
<div class="line">        <span class="comment">// Return true if supported, false if not supported</span></div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">false</span>; <span class="comment">// Default: not supported</span></div>
<div class="line">    }</div>
<div class="line">    </div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">    <span class="keywordtype">bool</span> initialized_ = <span class="keyword">false</span>;  <span class="comment">// Track initialization state</span></div>
<div class="line">};</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md123"></a>
Step 2: Platform-Specific Examples</h2>
<h3><a class="anchor" id="autotoc_md124"></a>
ESP32 (ESP-IDF)</h3>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;driver/i2c.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;pcal95555.hpp&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span>Esp32I2cBus : <span class="keyword">public</span> pcal95555::I2cInterface&lt;Esp32I2cBus&gt; {</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    <span class="keywordtype">bool</span> Write(uint8_t addr, uint8_t reg, <span class="keyword">const</span> uint8_t* data, <span class="keywordtype">size_t</span> len) {</div>
<div class="line">        i2c_cmd_handle_t cmd = i2c_cmd_link_create();</div>
<div class="line">        i2c_master_start(cmd);</div>
<div class="line">        i2c_master_write_byte(cmd, (addr &lt;&lt; 1) | I2C_MASTER_WRITE, <span class="keyword">true</span>);</div>
<div class="line">        i2c_master_write_byte(cmd, reg, <span class="keyword">true</span>);</div>
<div class="line">        i2c_master_write(cmd, (uint8_t*)data, len, <span class="keyword">true</span>);</div>
<div class="line">        i2c_master_stop(cmd);</div>
<div class="line">        esp_err_t ret = i2c_master_cmd_begin(I2C_NUM_0, cmd, 1000 / portTICK_PERIOD_MS);</div>
<div class="line">        i2c_cmd_link_delete(cmd);</div>
<div class="line">        <span class="keywordflow">return</span> ret == ESP_OK;</div>
<div class="line">    }</div>
<div class="line">    </div>
<div class="line">    <span class="keywordtype">bool</span> Read(uint8_t addr, uint8_t reg, uint8_t* data, <span class="keywordtype">size_t</span> len) {</div>
<div class="line">        i2c_cmd_handle_t cmd = i2c_cmd_link_create();</div>
<div class="line">        i2c_master_start(cmd);</div>
<div class="line">        i2c_master_write_byte(cmd, (addr &lt;&lt; 1) | I2C_MASTER_WRITE, <span class="keyword">true</span>);</div>
<div class="line">        i2c_master_write_byte(cmd, reg, <span class="keyword">true</span>);</div>
<div class="line">        i2c_master_start(cmd);</div>
<div class="line">        i2c_master_write_byte(cmd, (addr &lt;&lt; 1) | I2C_MASTER_READ, <span class="keyword">true</span>);</div>
<div class="line">        i2c_master_read(cmd, data, len, I2C_MASTER_LAST_NACK);</div>
<div class="line">        i2c_master_stop(cmd);</div>
<div class="line">        esp_err_t ret = i2c_master_cmd_begin(I2C_NUM_0, cmd, 1000 / portTICK_PERIOD_MS);</div>
<div class="line">        i2c_cmd_link_delete(cmd);</div>
<div class="line">        <span class="keywordflow">return</span> ret == ESP_OK;</div>
<div class="line">    }</div>
<div class="line">};</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md125"></a>
STM32 (HAL)</h3>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;stm32f4xx_hal.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;pcal95555.hpp&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">extern</span> I2C_HandleTypeDef hi2c1;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span>STM32I2cBus : <span class="keyword">public</span> pcal95555::I2cInterface&lt;STM32I2cBus&gt; {</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    <span class="keywordtype">bool</span> Write(uint8_t addr, uint8_t reg, <span class="keyword">const</span> uint8_t *data, <span class="keywordtype">size_t</span> len) {</div>
<div class="line">        <span class="comment">// STM32 HAL uses 8-bit address (7-bit &lt;&lt; 1)</span></div>
<div class="line">        <span class="keywordflow">return</span> HAL_I2C_Mem_Write(&amp;hi2c1, addr &lt;&lt; 1, reg, </div>
<div class="line">                                 I2C_MEMADD_SIZE_8BIT, </div>
<div class="line">                                 (uint8_t*)data, len, </div>
<div class="line">                                 HAL_MAX_DELAY) == HAL_OK;</div>
<div class="line">    }</div>
<div class="line">    </div>
<div class="line">    <span class="keywordtype">bool</span> Read(uint8_t addr, uint8_t reg, uint8_t *data, <span class="keywordtype">size_t</span> len) {</div>
<div class="line">        <span class="keywordflow">return</span> HAL_I2C_Mem_Read(&amp;hi2c1, addr &lt;&lt; 1, reg,</div>
<div class="line">                                I2C_MEMADD_SIZE_8BIT,</div>
<div class="line">                                data, len,</div>
<div class="line">                                HAL_MAX_DELAY) == HAL_OK;</div>
<div class="line">    }</div>
<div class="line">};</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md126"></a>
Arduino</h3>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;Wire.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &quot;pcal95555.hpp&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span>ArduinoI2cBus : <span class="keyword">public</span> pcal95555::I2cInterface&lt;ArduinoI2cBus&gt; {</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    <span class="keywordtype">bool</span> Write(uint8_t addr, uint8_t reg, <span class="keyword">const</span> uint8_t *data, <span class="keywordtype">size_t</span> len) {</div>
<div class="line">        Wire.beginTransmission(addr);</div>
<div class="line">        Wire.write(reg);</div>
<div class="line">        Wire.write(data, len);</div>
<div class="line">        <span class="keywordflow">return</span> Wire.endTransmission() == 0;</div>
<div class="line">    }</div>
<div class="line">    </div>
<div class="line">    <span class="keywordtype">bool</span> Read(uint8_t addr, uint8_t reg, uint8_t *data, <span class="keywordtype">size_t</span> len) {</div>
<div class="line">        Wire.beginTransmission(addr);</div>
<div class="line">        Wire.write(reg);</div>
<div class="line">        <span class="keywordflow">if</span> (Wire.endTransmission(<span class="keyword">false</span>) != 0) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">        </div>
<div class="line">        Wire.requestFrom(addr, len);</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; len &amp;&amp; Wire.available(); i++) {</div>
<div class="line">            data[i] = Wire.read();</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">    }</div>
<div class="line">};</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md127"></a>
Common Pitfalls</h1>
<h2><a class="anchor" id="autotoc_md128"></a>
❌ Don't Use Virtual Functions</h2>
<div class="fragment"><div class="line"><span class="comment">// WRONG - defeats the purpose of CRTP</span></div>
<div class="line"><span class="keyword">class </span>MyI2c : <span class="keyword">public</span> pcal95555::I2cInterface&lt;MyI2c&gt; {</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">bool</span> Write(...)<span class="keyword"> override </span>{  <span class="comment">// ❌ Virtual keyword not needed</span></div>
<div class="line">        <span class="comment">// ...</span></div>
<div class="line">    }</div>
<div class="line">};</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md129"></a>
✅ Correct CRTP Implementation</h2>
<div class="fragment"><div class="line"><span class="comment">// CORRECT - no virtual keyword</span></div>
<div class="line"><span class="keyword">class </span>MyI2c : <span class="keyword">public</span> pcal95555::I2cInterface&lt;MyI2c&gt; {</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    <span class="keywordtype">bool</span> Write(...) {  <span class="comment">// ✅ Direct implementation</span></div>
<div class="line">        <span class="comment">// ...</span></div>
<div class="line">    }</div>
<div class="line">};</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md130"></a>
❌ Don't Forget the Template Parameter</h2>
<div class="fragment"><div class="line"><span class="comment">// WRONG - missing template parameter</span></div>
<div class="line"><span class="keyword">class </span>MyI2c : <span class="keyword">public</span> pcal95555::I2cInterface {  <span class="comment">// ❌ Compiler error</span></div>
<div class="line">    <span class="comment">// ...</span></div>
<div class="line">};</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md131"></a>
✅ Correct Template Parameter</h2>
<div class="fragment"><div class="line"><span class="comment">// CORRECT - pass your class as template parameter</span></div>
<div class="line"><span class="keyword">class </span>MyI2c : <span class="keyword">public</span> pcal95555::I2cInterface&lt;MyI2c&gt; {  <span class="comment">// ✅</span></div>
<div class="line">    <span class="comment">// ...</span></div>
<div class="line">};</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md132"></a>
Testing Your Implementation</h1>
<p>After implementing the interface, test it:</p>
<div class="fragment"><div class="line">MyPlatformI2c i2c;</div>
<div class="line"><span class="comment">// Constructor takes A0, A1, A2 pin levels (all LOW = address 0x20, default)</span></div>
<div class="line"><span class="comment">// Optional: pass ChipVariant to skip auto-detection</span></div>
<div class="line">pcal95555::PCAL95555&lt;MyPlatformI2c&gt; gpio(&amp;i2c, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>);</div>
<div class="line"> </div>
<div class="line">gpio.ResetToDefault();</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Check which chip variant was detected</span></div>
<div class="line"><span class="keywordflow">if</span> (gpio.HasAgileIO()) {</div>
<div class="line">    printf(<span class="stringliteral">&quot;PCAL9555A detected - full feature set\n&quot;</span>);</div>
<div class="line">} <span class="keywordflow">else</span> {</div>
<div class="line">    printf(<span class="stringliteral">&quot;PCA9555 detected - standard GPIO only\n&quot;</span>);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">gpio.SetPinDirection(0, pcal95555::PCAL95555&lt;MyPlatformI2c&gt;::GPIODir::Output);</div>
<div class="line">gpio.WritePin(0, <span class="keyword">true</span>);</div>
<div class="line"><span class="keywordtype">bool</span> value = gpio.ReadPin(1);</div>
<div class="line"><span class="comment">// Interface works!</span></div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md133"></a>
Next Steps</h1>
<ul>
<li>See <a class="el" href="md_docs_2configuration.html">Configuration</a> for driver configuration options</li>
<li>Check <a class="el" href="md_docs_2examples.html">Examples</a> for complete usage examples</li>
<li>Review <a class="el" href="md_docs_2api__reference.html">API Reference</a> for all available methods </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.10.0
</small></address>
</body>
</html>
